
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>QML 101 - Some basic concepts &#8212; Quantum Tutorials</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script kind="utterances">

    var commentsRunWhenDOMLoaded = cb => {
    if (document.readyState != 'loading') {
        cb()
    } else if (document.addEventListener) {
        document.addEventListener('DOMContentLoaded', cb)
    } else {
        document.attachEvent('onreadystatechange', function() {
        if (document.readyState == 'complete') cb()
        })
    }
}

var addUtterances = () => {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src = "https://utteranc.es/client.js";
    script.async = "async";

    script.setAttribute("repo", "Alqor-UG/quantum-tutorials");
    script.setAttribute("issue-term", "pathname");
    script.setAttribute("theme", "github-light");
    script.setAttribute("label", "ðŸ’¬ comment");
    script.setAttribute("crossorigin", "anonymous");

    sections = document.querySelectorAll("div.section");
    if (sections !== null) {
        section = sections[sections.length-1];
        section.appendChild(script);
    }
}
commentsRunWhenDOMLoaded(addUtterances);
</script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="QML 102 - Deeper Classifiers" href="qml_102.html" />
    <link rel="prev" title="QML 001 - A summary of classical supervised learning" href="qml_001.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
      
      
      <h1 class="site-logo" id="site-title">Quantum Tutorials</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro.html">
   Welcome to our quantum tutorials
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  A beginners guide to QML
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="qml_intro.html">
   Course summary for a beginners guide to QML
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="qml_001.html">
   QML 001 - A summary of classical supervised learning
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   QML 101 - Some basic concepts
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="qml_102.html">
   QML 102 - Deeper Classifiers
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="qml_103.html">
   QML 103 - Teaching the circle
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="qml_104.html">
   QML 104 - More is different ? Working with multiple qubits
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Generative modeling with quantum hardware
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../generative_modeling/gmqh_intro.html">
   Summary of generative modeling with quantum hardware
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../generative_modeling/generative_modeling_101.html">
   Tutorial 1 â€“ A baby example of generative modeling
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../generative_modeling/generative_modeling_102.html">
   Tutorial 2 â€“ Training generative models
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../generative_modeling/generative_modeling_103.html">
   Tutorial 3 â€“ An untrained generative model with qubits
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../generative_modeling/generative_modeling_104.html">
   Tutorial 4 â€“ A trained generative model with a few qubits
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Introduction to quantum technologies
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../qtech_basics/qtech_summary.html">
   Course summary for introduction to quantum technologies
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../qtech_basics/qtech_intro.html">
   Tutorial 1 - Basic concepts of quantum technologies
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../qtech_basics/quantum_metrology.html">
   Tutorial 2 - Quantum metrology
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../qtech_basics/bell_inequalities.html">
   Tutorial on the nobel prize 2022 - How to win Bellâ€™s game
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Introduction to quantum hardware
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../hardware_tutorial/qhw_intro.html">
   Course summary for introduction to quantum hardware
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../hardware_tutorial/quantum_hardware_101.html">
   Tutorial 1 - The qubit or  the two level system
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../hardware_tutorial/quantum_hardware_102.html">
   Tutorial 2 - Continuous variables or the quantum harmonic oscillator
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../hardware_tutorial/quantum_hardware_103.html">
   Tutorial 3 - A few words about quantum computing with trapped ions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../hardware_tutorial/quantum_hardware_104.html">
   Tutorial 4 - A few words about quantum computing with superconducting qubits
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../hardware_tutorial/quantum_hardware_105.html">
   Tutorial 5 -Quantum simulation with cold atoms
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/beginner_qml/qml_101.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/Alqor-UG/quantum-tutorials"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/Alqor-UG/quantum-tutorials/issues/new?title=Issue%20on%20page%20%2Fbeginner_qml/qml_101.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/Alqor-UG/quantum-tutorials/main?urlpath=tree/book/beginner_qml/qml_101.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#a-simple-learning-task">
   A simple learning task
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#a-first-algorithm">
   A first algorithm
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#training">
   Training
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#test">
   Test
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#outlook-for-supervised-learning">
   Outlook for supervised learning
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>QML 101 - Some basic concepts</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#a-simple-learning-task">
   A simple learning task
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#a-first-algorithm">
   A first algorithm
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#training">
   Training
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#test">
   Test
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#outlook-for-supervised-learning">
   Outlook for supervised learning
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="qml-101-some-basic-concepts">
<span id="qml101"></span><h1>QML 101 - Some basic concepts<a class="headerlink" href="#qml-101-some-basic-concepts" title="Permalink to this headline">Â¶</a></h1>
<p>This is the second part of our beginners guide to quantum machine learning. In the last part we introduced some basic notions of classical supervised learning, on which we will build up on. In this tutorial, we will discuss some basic ideas behind quantum machine learning. Hereby, we focus on classifiers, which are part of the big class of supervised (deep) learning algorithms.</p>
<p>The notebook is structured as follows:</p>
<ul class="simple">
<li><p>We introduce the learning task of classifying data pointsÂ <span class="math notranslate nohighlight">\(x_i\)</span>Â with labelsÂ <span class="math notranslate nohighlight">\(y_i\)</span></p></li>
<li><p>We introduce the circuit structure and the cost function.</p></li>
<li><p>We provide simple training</p></li>
<li><p>We test the performance of the circuit.</p></li>
</ul>
<p>We will always focus on simplicity throughout this tutorial and leave the more complex discussions to the extensive literature.</p>
<div class="section" id="a-simple-learning-task">
<h2>A simple learning task<a class="headerlink" href="#a-simple-learning-task" title="Permalink to this headline">Â¶</a></h2>
<p>For simplicity we will start out with a simple problem, where each data set has only a single variable and extend it later to higher dimensional data sets.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># only necessary on colab

!pip install qiskit
!pip install pylatexenc
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>from typing import Union, List

import numpy as np
import matplotlib.pyplot as plt

from tqdm import tqdm
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>np.random.seed(1)
x = np.random.uniform(-np.pi, np.pi, 100)
y = 1.0 * (abs(x) &gt; np.pi / 2)

f, ax = plt.subplots()
ax.plot(x, y, &quot;o&quot;)
ax.set_xlabel(&quot;input value&quot;)
ax.set_ylabel(&quot;label&quot;)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;label&#39;)
</pre></div>
</div>
<img alt="../_images/qml_101_4_1.png" src="../_images/qml_101_4_1.png" />
</div>
</div>
<p>The task will then be to predict the label <span class="math notranslate nohighlight">\(y_i\)</span> from the input value <span class="math notranslate nohighlight">\(x_i\)</span>. To get started we have to divide the data set into a training part and a test part:</p>
<ul class="simple">
<li><p>On the <em>training set</em> we will optimize the algorithm to achieve the highest possible accuracy in predicting the label.</p></li>
<li><p>On the <em>test set</em> we will test the performance of the algorithm with data it has never seen.</p></li>
</ul>
<p>The usual problem is here to find a good balance between a sufficient amount of training data, yet leaving enough test data to have a statistically significant test.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>from sklearn.model_selection import train_test_split
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>x_train, x_test, y_train, y_test = train_test_split(
    x, y, test_size=0.20, random_state=42
)

f, (ax1, ax2) = plt.subplots(1, 2, figsize=(15, 5), sharex=True, sharey=True)
ax1.plot(x_train, y_train, &quot;o&quot;)
ax1.set_xlabel(&quot;input value&quot;)
ax1.set_ylabel(&quot; given labels&quot;)
ax1.set_title(&quot;training data&quot;)

ax2.plot(x_test, y_test, &quot;o&quot;)
ax2.set_xlabel(&quot;input value&quot;)
ax2.set_title(&quot;test data&quot;)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;test data&#39;)
</pre></div>
</div>
<img alt="../_images/qml_101_7_1.png" src="../_images/qml_101_7_1.png" />
</div>
</div>
</div>
<div class="section" id="a-first-algorithm">
<h2>A first algorithm<a class="headerlink" href="#a-first-algorithm" title="Permalink to this headline">Â¶</a></h2>
<p>It is now time to set up the algorithm for the training. Given that there are only two labels, we can directly work with a single qubit. The algorithm is then of the following structure:</p>
<ol class="simple">
<li><p>Prepare the initial state.</p></li>
<li><p>Apply a parametrized circuit with parameters <span class="math notranslate nohighlight">\(\mathbf{w}\)</span> that depend on the input <span class="math notranslate nohighlight">\(U(\mathbf{w}, x_i)\)</span>.</p></li>
<li><p>Read out the label from the measurement of the qubit.</p></li>
</ol>
<p>In the simplest of all cases, we might then just apply a single qubit rotation with the angle <span class="math notranslate nohighlight">\(w x_i\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>from qiskit.circuit import QuantumCircuit, Parameter
from qiskit import Aer

sim = Aer.get_backend(&quot;aer_simulator&quot;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>theta = Parameter(r&quot;$\theta$&quot;)

qc = QuantumCircuit(1)
qc.rx(theta, 0)
qc.measure_all()
qc.draw(&quot;mpl&quot;)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/qml_101_10_0.png" src="../_images/qml_101_10_0.png" />
</div>
</div>
<p>We can now look at the performance of the code with some randomly initialized weight in predicting the appropiate label.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>def get_accuracy(
    qc: QuantumCircuit, weight: float, xvals: List[float], yvals: List[int]
) -&gt; Union[float, List[int]]:
    &quot;&quot;&quot;
    Calculates the accuracy of the circuit for a given set of data.

    Args:
      qc: the quantum circuit
      weight: the training parameter
      xvals: the input values
      yvals: the labels
    Returns:
      The accuracy and the predicted labels.
    &quot;&quot;&quot;
    pred_labels = np.zeros(len(xvals))
    accurate_prediction = 0
    for ii, xinput, yinput in zip(range(len(xvals)), xvals, yvals.astype(int)):
        # set the circuit parameter
        circuit = qc.assign_parameters(
            {theta: weight * xinput},
            inplace=False,
        )
        # run the job and obtain the counts
        job = sim.run(circuit, shots=1000)
        counts1 = job.result().get_counts()

        # obtain the predicted label on average
        if &quot;0&quot; in counts1:
            pred_label = 1 * (counts1[&quot;0&quot;] &lt; 500)
        else:
            pred_label = 1
        pred_labels[ii] = pred_label
        if yinput == pred_label:
            accurate_prediction += 1
    return accurate_prediction / len(yvals), pred_labels
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>weight = 0.8

accuracy, y_pred = get_accuracy(qc, weight=weight, xvals=x_train, yvals=y_train)

false_label = abs(y_pred - y_train) &gt; 0

x_false = x_train[false_label]
y_false = y_pred[false_label]

print(f&quot;The circuit has an accuracy of {accuracy}&quot;)
f, ax = plt.subplots()
ax.plot(x_train, y_pred, &quot;o&quot;, label=&quot;predicted label&quot;)
ax.plot(x_false, y_false, &quot;ro&quot;, label=&quot;false label&quot;)
ax.legend()
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The circuit has an accuracy of 0.9
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x7ff478a0ef70&gt;
</pre></div>
</div>
<img alt="../_images/qml_101_13_2.png" src="../_images/qml_101_13_2.png" />
</div>
</div>
</div>
<div class="section" id="training">
<h2>Training<a class="headerlink" href="#training" title="Permalink to this headline">Â¶</a></h2>
<p>To improve the performance of the circuit, we have to train it. This basically involves the minimization of some loss function as a function of the circuit parameters <span class="math notranslate nohighlight">\(\mathbf{w}\)</span>. In this example we can simply calculate the accuracy of the circuit as a function of the weight and obtain its minimimum.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>weights = np.linspace(0, 2, 50)
accuracies = np.zeros(50)

for ii, weight_val in enumerate(tqdm(weights)):
    accuracy, y_pred = get_accuracy(qc, weight=weight_val, xvals=x_train, yvals=y_train)
    accuracies[ii] = accuracy
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 50/50 [00:06&lt;00:00,  8.14it/s]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>opt_weight = weights[accuracies.argmax()]

f, ax = plt.subplots()
ax.plot(weights, accuracies)
ax.axvline(opt_weight, color=&quot;C1&quot;, label=&quot;optimal weight&quot;)
ax.set_ylabel(&quot;accuracy&quot;)
ax.set_xlabel(&quot;weights&quot;)
ax.legend()
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x7ff4aca197f0&gt;
</pre></div>
</div>
<img alt="../_images/qml_101_16_1.png" src="../_images/qml_101_16_1.png" />
</div>
</div>
<p>We can now test the accuracy on the optimal value of the weights again to obtain.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>accuracy, y_pred = get_accuracy(qc, weight=opt_weight, xvals=x_train, yvals=y_train)

false_label = abs(y_pred - y_train) &gt; 0

x_false = x_train[false_label]
y_false = y_pred[false_label]

f, ax = plt.subplots()
ax.plot(x_train, y_pred, &quot;o&quot;, label=&quot;predicted label&quot;)
ax.plot(x_false, y_false, &quot;ro&quot;, label=&quot;false label&quot;)
ax.legend()


print(f&quot;The trained circuit has an accuracy of {accuracy:.2}&quot;)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The trained circuit has an accuracy of 1.0
</pre></div>
</div>
<img alt="../_images/qml_101_18_1.png" src="../_images/qml_101_18_1.png" />
</div>
</div>
</div>
<div class="section" id="test">
<h2>Test<a class="headerlink" href="#test" title="Permalink to this headline">Â¶</a></h2>
<p>Having finished the training, we can test the circuit now on data points that it has never seen.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>test_accuracy, y_test_pred = get_accuracy(
    qc, weight=opt_weight, xvals=x_test, yvals=y_test
)

false_label = abs(y_test_pred - y_test) &gt; 0

x_false = x_test[false_label]
y_false = y_test_pred[false_label]

print(f&quot;The circuit has a test accuracy of {test_accuracy:.2}&quot;)
f, ax = plt.subplots()
ax.plot(x_test, y_test_pred, &quot;o&quot;, label=&quot;predicted label&quot;)
ax.plot(x_false, y_false, &quot;ro&quot;, label=&quot;false label&quot;)
ax.legend()
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The circuit has a test accuracy of 1.0
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x7ff4acb05cd0&gt;
</pre></div>
</div>
<img alt="../_images/qml_101_20_2.png" src="../_images/qml_101_20_2.png" />
</div>
</div>
</div>
<div class="section" id="outlook-for-supervised-learning">
<h2>Outlook for supervised learning<a class="headerlink" href="#outlook-for-supervised-learning" title="Permalink to this headline">Â¶</a></h2>
<p>In this tutorial, we studied some basic concepts like training and classification for an extremely simple case.</p>
<ul class="simple">
<li><p>In the <a class="reference internal" href="qml_102.html#qml102"><span class="std std-ref">next tutorial</span></a>, we will see how deeper circuits allow us to learn more complex dependencies between input and output.</p></li>
<li><p>The extension towards higher dimensional inputs allows us to look into more complext tasks like image processing.</p></li>
</ul>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "Alqor-UG/quantum-tutorials",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./beginner_qml"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="qml_001.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">QML 001 - A summary of classical supervised learning</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="qml_102.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">QML 102 - Deeper Classifiers</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Quantum Tutorials Community<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>